<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean Barcode & QR Code Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.3/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .info-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .download-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        
        .requirements-box {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .requirements-box h4 {
            margin: 0 0 10px 0;
            font-size: 1.1em;
        }

        .requirements-box ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            flex: 1;
            min-width: 200px;
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-generate:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-preview {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-preview:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.3);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .progress-container {
            display: none;
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            color: #555;
        }
        
        .preview-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .preview-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .preview-item canvas {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
        }
        
        .preview-item .barcode-value {
            margin-top: 10px;
            font-weight: bold;
            color: #333;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîó Clean Barcode & QR Generator</h1>
        
        <div class="info-box">
            <h3>üìä Exact Requirements Generator</h3>
            <p>Generate 4000 clean PNG files for values 4000 to 5999<br>
            ‚Ä¢ 2000 Code 128 barcodes (with proper checksums)<br>
            ‚Ä¢ 2000 QR codes</p>
        </div>

        <div class="requirements-box">
            <h4>‚úÖ Your Requirements:</h4>
            <ul>
                <li>Clean images with ONLY barcode/QR lines (no text labels)</li>
                <li>Code 128 barcodes with proper checksums</li>
                <li>PNG format only</li>
                <li>Values 4000-5999 (2000 each type)</li>
                <li>Single ZIP download</li>
            </ul>
        </div>
        
        <div class="download-info">
            üíæ Files will be named: barcode_4000.png, qr_4000.png, etc.
        </div>
        
        <div class="button-group">
            <button class="btn-preview" onclick="generatePreview()">üîç Preview Clean Samples</button>
            <button class="btn-generate" onclick="generateAllCodes()">üöÄ Generate All 4000 Files</button>
        </div>
        
        <div class="progress-container" id="progressContainer">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Preparing...</div>
        </div>
        
        <div id="status"></div>
        
        <div class="preview-section">
            <div id="previewGrid" class="preview-grid"></div>
        </div>
    </div>

    <script>
        function generateCleanBarcode(value) {
            const canvas = document.createElement('canvas');
            
            try {
                // Generate Code 128 barcode with JsBarcode - clean version
                JsBarcode(canvas, value.toString(), {
                    format: "CODE128",
                    width: 2,           // Bar width
                    height: 100,        // Bar height  
                    displayValue: false, // NO TEXT - clean barcode only
                    margin: 0,          // No margins
                    background: "#FFFFFF",
                    lineColor: "#000000"
                });
                
                return canvas;
            } catch (error) {
                console.error('Error generating barcode for value:', value, error);
                return null;
            }
        }
        
        async function generateCleanQRCode(value) {
            try {
                const canvas = document.createElement('canvas');
                await QRCode.toCanvas(canvas, value.toString(), {
                    width: 200,         // Fixed size
                    height: 200,
                    margin: 0,          // No margins - clean QR only
                    color: {
                        dark: '#000000',
                        light: '#FFFFFF'
                    }
                });
                return canvas;
            } catch (error) {
                console.error('Error generating QR code for value:', value, error);
                return null;
            }
        }
        
        function canvasToBlob(canvas) {
            return new Promise((resolve) => {
                canvas.toBlob(resolve, 'image/png'); // PNG only as requested
            });
        }
        
        function updateProgress(current, total, type = '') {
            const percent = Math.round((current / total) * 100);
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = `Generated ${current} of ${total} files (${percent}%) - ${type}`;
        }
        
        function showStatus(message, type = 'success') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }
        
        function downloadZip(zip, filename) {
            zip.generateAsync({type:"blob"}).then(function(content) {
                const url = URL.createObjectURL(content);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        }
        
        async function generateAllCodes() {
            const progressContainer = document.getElementById('progressContainer');
            const generateBtn = document.querySelector('.btn-generate');
            
            // Show progress and disable button
            progressContainer.style.display = 'block';
            generateBtn.disabled = true;
            generateBtn.textContent = '‚è≥ Generating 4000 files...';
            
            try {
                const zip = new JSZip();
                let processed = 0;
                const totalFiles = 4000; // 2000 barcodes + 2000 QR codes
                
                // Generate Code 128 barcodes (4000-5999)
                updateProgress(0, totalFiles, 'Starting Code 128 barcodes...');
                for (let i = 4000; i <= 5999; i++) {
                    const canvas = generateCleanBarcode(i);
                    if (canvas) {
                        const filename = `barcode_${i}.png`;
                        const blob = await canvasToBlob(canvas);
                        zip.file(filename, blob);
                        processed++;
                        
                        // Update progress every 50 files for better performance
                        if (processed % 50 === 0 || processed === 2000) {
                            updateProgress(processed, totalFiles, 'Code 128 barcodes');
                            await new Promise(resolve => setTimeout(resolve, 1));
                        }
                    }
                }
                
                // Generate QR codes (4000-5999)
                updateProgress(processed, totalFiles, 'Starting QR codes...');
                for (let i = 4000; i <= 5999; i++) {
                    const canvas = await generateCleanQRCode(i);
                    if (canvas) {
                        const filename = `qr_${i}.png`;
                        const blob = await canvasToBlob(canvas);
                        zip.file(filename, blob);
                        processed++;
                        
                        // Update progress every 50 files
                        if (processed % 50 === 0 || processed === totalFiles) {
                            updateProgress(processed, totalFiles, 'QR codes');
                            await new Promise(resolve => setTimeout(resolve, 1));
                        }
                    }
                }
                
                // Generate and download ZIP
                document.getElementById('progressText').textContent = 'Creating ZIP file...';
                const zipFilename = `barcodes_and_qrcodes_4000-5999.zip`;
                downloadZip(zip, zipFilename);
                
                showStatus(`‚úÖ Successfully generated all 4000 files! Download started automatically.`, 'success');
                generateBtn.textContent = 'üì¶ Download Complete!';
                
            } catch (error) {
                console.error('Error during batch generation:', error);
                showStatus('‚ùå Error occurred during generation. Check console for details.', 'error');
                generateBtn.textContent = 'üöÄ Generate All 4000 Files';
            } finally {
                generateBtn.disabled = false;
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                    if (generateBtn.textContent === 'üì¶ Download Complete!') {
                        generateBtn.textContent = 'üöÄ Generate All 4000 Files';
                    }
                }, 5000);
            }
        }
        
        async function generatePreview() {
            const previewGrid = document.getElementById('previewGrid');
            previewGrid.innerHTML = '';
            
            // Generate preview for first 3 values (4000-4002) to show clean output
            for (let i = 4000; i <= 4002; i++) {
                // Generate clean barcode
                const barcodeCanvas = generateCleanBarcode(i);
                if (barcodeCanvas) {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    
                    const clonedCanvas = document.createElement('canvas');
                    clonedCanvas.width = barcodeCanvas.width;
                    clonedCanvas.height = barcodeCanvas.height;
                    const ctx = clonedCanvas.getContext('2d');
                    ctx.drawImage(barcodeCanvas, 0, 0);
                    
                    const valueDiv = document.createElement('div');
                    valueDiv.className = 'barcode-value';
                    valueDiv.textContent = `Clean Code 128: ${i}`;
                    
                    previewItem.appendChild(clonedCanvas);
                    previewItem.appendChild(valueDiv);
                    previewGrid.appendChild(previewItem);
                }
                
                // Generate clean QR code
                const qrCanvas = await generateCleanQRCode(i);
                if (qrCanvas) {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    
                    const clonedCanvas = document.createElement('canvas');
                    clonedCanvas.width = qrCanvas.width;
                    clonedCanvas.height = qrCanvas.height;
                    const ctx = clonedCanvas.getContext('2d');
                    ctx.drawImage(qrCanvas, 0, 0);
                    
                    const valueDiv = document.createElement('div');
                    valueDiv.className = 'barcode-value';
                    valueDiv.textContent = `Clean QR Code: ${i}`;
                    
                    previewItem.appendChild(clonedCanvas);
                    previewItem.appendChild(valueDiv);
                    previewGrid.appendChild(previewItem);
                }
            }
            
            showStatus(`üìã Preview generated - showing clean images without text labels (values 4000-4002)`, 'success');
        }
        
        // Generate initial preview when page loads
        window.addEventListener('load', function() {
            setTimeout(generatePreview, 500);
        });
    </script>
</body>
</html>
